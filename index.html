<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LibAscon: LibAscon - Lightweight Authenticated Encryption &amp; Hashing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LibAscon<span id="projectnumber">&#160;1.1.2</span>
   </div>
   <div id="projectbrief">Lightweight Authenticated Encryption &amp; Hashing,         also with Init-Update-Final paradigm.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">LibAscon - Lightweight Authenticated Encryption &amp; Hashing </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_README"></a></p>
<p ><a href="https://github.com/TheMatjaz/LibAscon/actions/workflows/build_master.yml"><img src="https://github.com/TheMatjaz/LibAscon/actions/workflows/build_master.yml/badge.svg" alt="Build Status Master" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/TheMatjaz/LibAscon/actions/workflows/build_develop.yml"><img src="https://github.com/TheMatjaz/LibAscon/actions/workflows/build_develop.yml/badge.svg" alt="Build Status Develop" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/TheMatjaz/LibAscon/releases/latest"><img src="https://img.shields.io/github/v/release/TheMatjaz/LibAscon" alt="GitHub release (latest by date)" class="inline"/></a> <a href="https://github.com/TheMatjaz/LibAscon/blob/master/LICENSE.md"><img src="https://img.shields.io/github/license/TheMatjaz/LibAscon" alt="GitHub" class="inline"/></a></p>
<p >LibAscon is an ISO C99/C11 cryptographic library wrapping the <a href="https://github.com/ascon/ascon-c">reference C implementation</a> of the Ascon family of lightweight authenticated encryption schemes with associated data (AEAD) and hashing functions, but it also includes Init-Update-Final processing and variable tag length. Heavily tested and ready for embedded systems!</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Disclaimer</h2>
<p >This is not a security-hardened implementation, just a simple one focused mostly on usability, portability and high(er) set of features There is no added protection against side-channel attacks other than what the Ascon algorithm itself provides by design.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Features</h1>
<p >LibAscon provides:</p>
<ul>
<li>3 AEAD ciphers:<ul>
<li>Ascon128 v1.2 (128 bit key, 64 bit rate)</li>
<li>Ascon128a v1.2 (128 bit key, 128 bit rate)</li>
<li>Ascon80pq v1.2 (160 bit key, 64 bit rate)</li>
</ul>
</li>
<li>2 hashing functions<ul>
<li>Ascon-Hash v1.2 (fixed-length output)</li>
<li>Ascon-XOF v1.2 (variable-length output)</li>
</ul>
</li>
<li><b>Online processing</b> (<b>Init-Update-Final</b> paradigm) for hashing and encryption/decryption. This means that the data can be processed one chunk at the time. Useful when operating on large amounts of data that are not available contiguously in memory, e.g. a too-large file or data in transmission.</li>
<li><b>Offline processing</b> (whole data contiguous in memory) is also available with a simple wrapper.</li>
<li><p class="startli"><b>Variable tag length</b> for authenticated encryption: can generate any tag length. Of course at least 16 bytes (128 bits) is recommended.</p>
<p class="startli">Note: the tag bytes above 16 bytes are an <b>extension</b> of the original Ascon algorithm using the same sponge squeezing technique as for the XOF;</p>
</li>
<li>Encryption/decryption can be performed <b>in-place</b>, without the need of a second output buffer.</li>
<li>AEAD tag may be provided to a <b>separate location</b>, i.e. not concatenated to the ciphertext.</li>
<li>Same performance as the original C implementation in <em>Release</em> mode, about 2x slower in <em>MinSizeRel</em> mode.</li>
<li>A <b><a href="https://thematjaz.github.io/LibAscon/">heavily documented</a> developer-friendly API</b>, making it easier to compile and add to your project, both through static and dynamic inclusion.</li>
<li>Tested with <b>100% line coverage</b>, with CI running on Linux, macOS and Windows with GCC, Clang and CL (MSVC).</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Usage example</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
En/decrypting using Ascon128's Init-Update-Final API</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ascon_8h.html">ascon.h</a>&quot;</span></div>
<div class="line"><span class="comment">// Initialisation</span></div>
<div class="line"><span class="comment">// We need the key and the nonce, both 128 bits.</span></div>
<div class="line"><span class="comment">// Note: Ascon80pq uses longer keys</span></div>
<div class="line"><span class="keyword">const</span> uint8_t secret_key[<a class="code hl_define" href="ascon_8h.html#a5d925f62c1deac9834156f754ec6c365">ASCON_AEAD128_KEY_LEN</a>] = {</div>
<div class="line">        1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6</div>
<div class="line">};</div>
<div class="line"><span class="keyword">const</span> uint8_t unique_nonce[<a class="code hl_define" href="ascon_8h.html#af7ad24ebb29bc3179e2b0a11c1b782e8">ASCON_AEAD_NONCE_LEN</a>] = {</div>
<div class="line">        1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6</div>
<div class="line">};</div>
<div class="line"><a class="code hl_struct" href="structascon__aead__ctx__t.html">ascon_aead_ctx_t</a> ctx;</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a368ec60db11cf197ca49a3290a81d1e2">ascon_aead128_init</a>(&amp;ctx, secret_key, unique_nonce);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Now we feed any associated data into the cipher first</span></div>
<div class="line"><span class="comment">// Our data is fragmented into 2 parts, so we feed one at the time.</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> associated_data_pt1[] = <span class="stringliteral">&quot;2 messages will foll&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> associated_data_pt2[] = <span class="stringliteral">&quot;ow, but they are both secret.&quot;</span>;</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a3ebc0909121a3f655164c14a2a850c53">ascon_aead128_assoc_data_update</a>(&amp;ctx, (uint8_t*) associated_data_pt1, strlen</div>
<div class="line">        (associated_data_pt1));</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a3ebc0909121a3f655164c14a2a850c53">ascon_aead128_assoc_data_update</a>(&amp;ctx, (uint8_t*) associated_data_pt2, strlen</div>
<div class="line">        (associated_data_pt2));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Next, we feed the plaintext, which is also fragmented in 2 parts.</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> plaintext_pt1[] = <span class="stringliteral">&quot;Hello, I&#39;m a secret mes&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> plaintext_pt2[] = <span class="stringliteral">&quot;sage and I should be encrypted!&quot;</span>;</div>
<div class="line">uint8_t buffer[100];</div>
<div class="line"><span class="comment">// The ciphertext is generated block-wise, so we need the return value</span></div>
<div class="line"><span class="comment">// to know how to offset the pointer to where the next ciphertext</span></div>
<div class="line"><span class="comment">// part should be written.</span></div>
<div class="line"><span class="keywordtype">size_t</span> ciphertext_len = 0;</div>
<div class="line">ciphertext_len += <a class="code hl_function" href="ascon_8h.html#aa3154ef7d24cd2aefac7526f47be7af4">ascon_aead128_encrypt_update</a>(</div>
<div class="line">        &amp;ctx, buffer + ciphertext_len,</div>
<div class="line">        (uint8_t*) plaintext_pt1, strlen(plaintext_pt1));</div>
<div class="line">ciphertext_len += <a class="code hl_function" href="ascon_8h.html#aa3154ef7d24cd2aefac7526f47be7af4">ascon_aead128_encrypt_update</a>(</div>
<div class="line">        &amp;ctx, buffer + ciphertext_len,</div>
<div class="line">        (uint8_t*) plaintext_pt2, strlen(plaintext_pt2));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Finally, we wrap up the encryption and generate the tag.</span></div>
<div class="line"><span class="comment">// There may still be some trailing ciphertext to be produced.</span></div>
<div class="line"><span class="comment">// The tag length can be specified. ASCON_AEAD_TAG_MIN_SECURE_LEN is</span></div>
<div class="line"><span class="comment">// the minimum recommended (128 b)</span></div>
<div class="line">uint8_t tag[<a class="code hl_define" href="ascon_8h.html#a01059c28b3716d7b8e334f770453eb2b">ASCON_AEAD_TAG_MIN_SECURE_LEN</a>];</div>
<div class="line">ciphertext_len += <a class="code hl_function" href="ascon_8h.html#a6362d5089ca5c3dd082722f233997e92">ascon_aead128_encrypt_final</a>(</div>
<div class="line">        &amp;ctx, buffer + ciphertext_len,</div>
<div class="line">        tag, <span class="keyword">sizeof</span>(tag));</div>
<div class="line"><span class="comment">// The final function zeroes out the context automatically.</span></div>
<div class="line"><span class="comment">// Now the buffer contains our ciphertext, long ciphertext_len bytes.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Now we can decrypt, reusing the same key, nonce and associated data</span></div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a368ec60db11cf197ca49a3290a81d1e2">ascon_aead128_init</a>(&amp;ctx, secret_key, unique_nonce);</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a3ebc0909121a3f655164c14a2a850c53">ascon_aead128_assoc_data_update</a>(&amp;ctx, (uint8_t*) associated_data_pt1,</div>
<div class="line">                                strlen(associated_data_pt1));</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a3ebc0909121a3f655164c14a2a850c53">ascon_aead128_assoc_data_update</a>(&amp;ctx, (uint8_t*) associated_data_pt2,</div>
<div class="line">                                strlen(associated_data_pt2));</div>
<div class="line"><span class="comment">// This time, we perform the decryption in-place, in the same buffer</span></div>
<div class="line"><span class="comment">// where the ciphertext it: to do so, we pass the same pointer for</span></div>
<div class="line"><span class="comment">// plaintext and ciphertext.</span></div>
<div class="line"><span class="keywordtype">size_t</span> plaintext_len = 0;</div>
<div class="line">plaintext_len += <a class="code hl_function" href="ascon_8h.html#a5e65fbd17fcdde9fd4621c5d65bdb4e3">ascon_aead128_decrypt_update</a>(</div>
<div class="line">        &amp;ctx, buffer,</div>
<div class="line">        buffer, ciphertext_len);</div>
<div class="line"><span class="comment">// The final decryption step automatically checks the tag</span></div>
<div class="line"><span class="keywordtype">bool</span> is_tag_valid = <span class="keyword">false</span>;</div>
<div class="line">plaintext_len += <a class="code hl_function" href="ascon_8h.html#ad966f02f3fc5a966216719a554e7453e">ascon_aead128_decrypt_final</a>(</div>
<div class="line">        &amp;ctx, buffer + plaintext_len,</div>
<div class="line">        &amp;is_tag_valid, tag, <span class="keyword">sizeof</span>(tag));</div>
<div class="line"><span class="comment">// The final function zeroes out the context automatically.</span></div>
<div class="line">buffer[plaintext_len] = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">// Null terminated, because it&#39;s text</span></div>
<div class="line">printf(<span class="stringliteral">&quot;Decrypted msg: %s, tag is valid: %d\n&quot;</span>, buffer, is_tag_valid);</div>
<div class="line"><span class="comment">// The macros ASCON_TAG_OK=true and ASCON_TAG_INVALID=false are also</span></div>
<div class="line"><span class="comment">// available if you prefer them over booleans for is_tag_valid.</span></div>
<div class="ttc" id="aascon_8h_html"><div class="ttname"><a href="ascon_8h.html">ascon.h</a></div><div class="ttdoc">Ascon cipher - Lightweight Authenticated Encryption &amp; Hashing, also with Init-Update-Final paradigm.</div></div>
<div class="ttc" id="aascon_8h_html_a01059c28b3716d7b8e334f770453eb2b"><div class="ttname"><a href="ascon_8h.html#a01059c28b3716d7b8e334f770453eb2b">ASCON_AEAD_TAG_MIN_SECURE_LEN</a></div><div class="ttdeci">#define ASCON_AEAD_TAG_MIN_SECURE_LEN</div><div class="ttdoc">Minimum recommended length in bytes of the authentication tag generated by the authenticated encrypti...</div><div class="ttdef"><b>Definition:</b> ascon.h:131</div></div>
<div class="ttc" id="aascon_8h_html_a368ec60db11cf197ca49a3290a81d1e2"><div class="ttname"><a href="ascon_8h.html#a368ec60db11cf197ca49a3290a81d1e2">ascon_aead128_init</a></div><div class="ttdeci">ASCON_API void ascon_aead128_init(ascon_aead_ctx_t *ctx, const uint8_t key[ASCON_AEAD128_KEY_LEN], const uint8_t nonce[ASCON_AEAD_NONCE_LEN])</div><div class="ttdoc">Online symmetric encryption/decryption using Ascon128, initialisation.</div></div>
<div class="ttc" id="aascon_8h_html_a3ebc0909121a3f655164c14a2a850c53"><div class="ttname"><a href="ascon_8h.html#a3ebc0909121a3f655164c14a2a850c53">ascon_aead128_assoc_data_update</a></div><div class="ttdeci">ASCON_API void ascon_aead128_assoc_data_update(ascon_aead_ctx_t *ctx, const uint8_t *assoc_data, size_t assoc_data_len)</div><div class="ttdoc">Online symmetric encryption/decryption using Ascon128, feeding associated data.</div></div>
<div class="ttc" id="aascon_8h_html_a5d925f62c1deac9834156f754ec6c365"><div class="ttname"><a href="ascon_8h.html#a5d925f62c1deac9834156f754ec6c365">ASCON_AEAD128_KEY_LEN</a></div><div class="ttdeci">#define ASCON_AEAD128_KEY_LEN</div><div class="ttdoc">Length in bytes of the secret symmetric key used for the Ascon128 cipher.</div><div class="ttdef"><b>Definition:</b> ascon.h:109</div></div>
<div class="ttc" id="aascon_8h_html_a5e65fbd17fcdde9fd4621c5d65bdb4e3"><div class="ttname"><a href="ascon_8h.html#a5e65fbd17fcdde9fd4621c5d65bdb4e3">ascon_aead128_decrypt_update</a></div><div class="ttdeci">ASCON_API size_t ascon_aead128_decrypt_update(ascon_aead_ctx_t *ctx, uint8_t *plaintext, const uint8_t *ciphertext, size_t ciphertext_len)</div><div class="ttdoc">Online symmetric decryption using Ascon128, feeding ciphertext and getting plaintext.</div></div>
<div class="ttc" id="aascon_8h_html_a6362d5089ca5c3dd082722f233997e92"><div class="ttname"><a href="ascon_8h.html#a6362d5089ca5c3dd082722f233997e92">ascon_aead128_encrypt_final</a></div><div class="ttdeci">ASCON_API size_t ascon_aead128_encrypt_final(ascon_aead_ctx_t *ctx, uint8_t *ciphertext, uint8_t *tag, size_t tag_len)</div><div class="ttdoc">Online symmetric encryption using Ascon128, finalisation and tag generation.</div></div>
<div class="ttc" id="aascon_8h_html_aa3154ef7d24cd2aefac7526f47be7af4"><div class="ttname"><a href="ascon_8h.html#aa3154ef7d24cd2aefac7526f47be7af4">ascon_aead128_encrypt_update</a></div><div class="ttdeci">ASCON_API size_t ascon_aead128_encrypt_update(ascon_aead_ctx_t *ctx, uint8_t *ciphertext, const uint8_t *plaintext, size_t plaintext_len)</div><div class="ttdoc">Online symmetric encryption using Ascon128, feeding plaintext and getting ciphertext.</div></div>
<div class="ttc" id="aascon_8h_html_ad966f02f3fc5a966216719a554e7453e"><div class="ttname"><a href="ascon_8h.html#ad966f02f3fc5a966216719a554e7453e">ascon_aead128_decrypt_final</a></div><div class="ttdeci">ASCON_API size_t ascon_aead128_decrypt_final(ascon_aead_ctx_t *ctx, uint8_t *plaintext, bool *is_tag_valid, const uint8_t *expected_tag, size_t expected_tag_len)</div><div class="ttdoc">Online symmetric decryption using Ascon128, finalisation and tag validation.</div></div>
<div class="ttc" id="aascon_8h_html_af7ad24ebb29bc3179e2b0a11c1b782e8"><div class="ttname"><a href="ascon_8h.html#af7ad24ebb29bc3179e2b0a11c1b782e8">ASCON_AEAD_NONCE_LEN</a></div><div class="ttdeci">#define ASCON_AEAD_NONCE_LEN</div><div class="ttdoc">Length in bytes of the public nonce used for authenticated encryption and decryption.</div><div class="ttdef"><b>Definition:</b> ascon.h:125</div></div>
<div class="ttc" id="astructascon__aead__ctx__t_html"><div class="ttname"><a href="structascon__aead__ctx__t.html">ascon_aead_ctx_t</a></div><div class="ttdoc">Cipher context for authenticated encryption and validated decryption.</div><div class="ttdef"><b>Definition:</b> ascon.h:224</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5"></a>
Encrypting using Ascon128's offline API for contiguous data</h2>
<div class="fragment"><div class="line"><span class="comment">// We need the key and the nonce, both 128 bits.</span></div>
<div class="line"><span class="comment">// Note: Ascon80pq uses longer keys</span></div>
<div class="line"><span class="keyword">const</span> uint8_t secret_key[<a class="code hl_define" href="ascon_8h.html#a5d925f62c1deac9834156f754ec6c365">ASCON_AEAD128_KEY_LEN</a>] = {</div>
<div class="line">        1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6</div>
<div class="line">};</div>
<div class="line"><span class="keyword">const</span> uint8_t unique_nonce[<a class="code hl_define" href="ascon_8h.html#af7ad24ebb29bc3179e2b0a11c1b782e8">ASCON_AEAD_NONCE_LEN</a>] = {</div>
<div class="line">        1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// For the &quot;offline&quot; operation, we need all data to be already contiguous</span></div>
<div class="line"><span class="comment">// in memory. The operation is just one Ascon function call for the user.</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> associated_data[] = <span class="stringliteral">&quot;1 contiguous message will follow.&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> plaintext[] = <span class="stringliteral">&quot;Hello, I&#39;m a secret message and I should be encrypted!&quot;</span>;</div>
<div class="line"> </div>
<div class="line">uint8_t buffer[100];</div>
<div class="line">uint8_t tag[42];</div>
<div class="line"><span class="comment">// To showcase the LibAscon extensions, we will generate an arbitrary-length</span></div>
<div class="line"><span class="comment">// tag. Here is 42 bytes, but shorter-than-default (16) tags are also</span></div>
<div class="line"><span class="comment">// possible e.g. 12 bytes for systems with heavy limitations.</span></div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#aad16ee534258583d3c658fa45dcd67a1">ascon_aead128_encrypt</a>(buffer,</div>
<div class="line">                      tag,</div>
<div class="line">                      secret_key,</div>
<div class="line">                      unique_nonce,</div>
<div class="line">                      (uint8_t*) associated_data,</div>
<div class="line">                      (uint8_t*) plaintext,</div>
<div class="line">                      strlen(associated_data),</div>
<div class="line">                      strlen(plaintext),</div>
<div class="line">                      <span class="keyword">sizeof</span>(tag));</div>
<div class="line"><span class="comment">// The function zeroes out the context automatically.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// The decryption looks almost the same. Just for fun, we will again</span></div>
<div class="line"><span class="comment">// reuse the same buffer where the ciphertext is to write the plaintext into.</span></div>
<div class="line"><span class="keywordtype">bool</span> is_tag_valid = <a class="code hl_function" href="ascon_8h.html#a9921ab2883cf48a221df0935f753864f">ascon_aead128_decrypt</a>(buffer, <span class="comment">// Output plaintext</span></div>
<div class="line">                                          secret_key,</div>
<div class="line">                                          unique_nonce,</div>
<div class="line">                                          (uint8_t*) associated_data,</div>
<div class="line">                                          (uint8_t*) buffer, <span class="comment">// Input ciphertext,</span></div>
<div class="line">                                          tag, <span class="comment">// Expected tag the ciphertext comes with</span></div>
<div class="line">                                          strlen(associated_data),</div>
<div class="line">                                          strlen(plaintext),</div>
<div class="line">                                          <span class="keyword">sizeof</span>(tag));</div>
<div class="line"><span class="comment">// This time we get a boolean as a return value, which is true when</span></div>
<div class="line"><span class="comment">// the tag is OK. To avoid confusion, it can also be compared to</span></div>
<div class="line"><span class="comment">// two handy macros</span></div>
<div class="line"><span class="keywordflow">if</span> (is_tag_valid == <a class="code hl_define" href="ascon_8h.html#ae4039ea40dc117ac4189ec25a812293e">ASCON_TAG_OK</a>) {</div>
<div class="line">    puts(<span class="stringliteral">&quot;Correct decryption!&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> { <span class="comment">// ASCON_TAG_INVALID</span></div>
<div class="line">    puts(<span class="stringliteral">&quot;Something went wrong!&quot;</span>);</div>
<div class="line">}</div>
<div class="line"><span class="comment">// The function zeroes out the context automatically.</span></div>
<div class="ttc" id="aascon_8h_html_a9921ab2883cf48a221df0935f753864f"><div class="ttname"><a href="ascon_8h.html#a9921ab2883cf48a221df0935f753864f">ascon_aead128_decrypt</a></div><div class="ttdeci">ASCON_API bool ascon_aead128_decrypt(uint8_t *plaintext, const uint8_t key[ASCON_AEAD128_KEY_LEN], const uint8_t nonce[ASCON_AEAD_NONCE_LEN], const uint8_t *assoc_data, const uint8_t *ciphertext, const uint8_t *expected_tag, size_t assoc_data_len, size_t ciphertext_len, size_t expected_tag_len)</div><div class="ttdoc">Offline symmetric decryption using Ascon128.</div></div>
<div class="ttc" id="aascon_8h_html_aad16ee534258583d3c658fa45dcd67a1"><div class="ttname"><a href="ascon_8h.html#aad16ee534258583d3c658fa45dcd67a1">ascon_aead128_encrypt</a></div><div class="ttdeci">ASCON_API void ascon_aead128_encrypt(uint8_t *ciphertext, uint8_t *tag, const uint8_t key[ASCON_AEAD128_KEY_LEN], const uint8_t nonce[ASCON_AEAD_NONCE_LEN], const uint8_t *assoc_data, const uint8_t *plaintext, size_t assoc_data_len, size_t plaintext_len, size_t tag_len)</div><div class="ttdoc">Offline symmetric encryption using Ascon128.</div></div>
<div class="ttc" id="aascon_8h_html_ae4039ea40dc117ac4189ec25a812293e"><div class="ttname"><a href="ascon_8h.html#ae4039ea40dc117ac4189ec25a812293e">ASCON_TAG_OK</a></div><div class="ttdeci">#define ASCON_TAG_OK</div><div class="ttdoc">The tag is valid thus the associated data and ciphertext were intact.</div><div class="ttdef"><b>Definition:</b> ascon.h:155</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
Keyed hashing using Ascon-XOF's Init-Update-Final API</h2>
<div class="fragment"><div class="line"><span class="comment">// We want to authenticate a message with a keyed hash and transmit it.</span></div>
<div class="line"><span class="keyword">const</span> uint8_t secret_key[] = {</div>
<div class="line">        1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6</div>
<div class="line">};</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> message_pt1[] = <span class="stringliteral">&quot;Hello, I&#39;m some data we need the digest of&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> message_pt2[] = <span class="stringliteral">&quot; but I&#39;m very long and I was not transmit&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> message_pt3[] = <span class="stringliteral">&quot;ted in one contiguous block.&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Preparing the Ascon-XOF function. The XOF allows arbitrary digest size,</span></div>
<div class="line"><span class="comment">// while Ascon-Hash (ascon_hash_init) has a fixed digest length.</span></div>
<div class="line"><span class="comment">// NOTE: Ascon-Hash and Ascon-XOF produce different outputs!</span></div>
<div class="line"><a class="code hl_struct" href="structascon__bufstate__t.html">ascon_hash_ctx_t</a> ctx;</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a2f6424f124ab43b23a801f39440b9a12">ascon_hash_xof_init</a>(&amp;ctx);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// If we want a Message Authentication Code that also proves authenticity,</span></div>
<div class="line"><span class="comment">// not only integrity of the message, we can simply prepend the key to the</span></div>
<div class="line"><span class="comment">// message to hash, just like we would for SHA-3. Length extension attacks</span></div>
<div class="line"><span class="comment">// are not a problem for Ascon-Hash/XOF, so the HMAC scheme is not needed.</span></div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a70136fcbc6c9bcd465221acb68bcbd0c">ascon_hash_xof_update</a>(&amp;ctx, (uint8_t*) secret_key, <span class="keyword">sizeof</span>(secret_key));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Feeding chunk by chunk</span></div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a70136fcbc6c9bcd465221acb68bcbd0c">ascon_hash_xof_update</a>(&amp;ctx, (uint8_t*) message_pt1, strlen(message_pt1));</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a70136fcbc6c9bcd465221acb68bcbd0c">ascon_hash_xof_update</a>(&amp;ctx, (uint8_t*) message_pt2, strlen(message_pt2));</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a70136fcbc6c9bcd465221acb68bcbd0c">ascon_hash_xof_update</a>(&amp;ctx, (uint8_t*) message_pt3, strlen(message_pt3));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Finally, we get a digest of arbitrary length</span></div>
<div class="line">uint8_t digest[21];  <span class="comment">// Choose any length from 0 to SIZE_MAX</span></div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#af966155aba9e0a9b14264d97ddafafdc">ascon_hash_xof_final</a>(&amp;ctx, digest, <span class="keyword">sizeof</span>(digest));</div>
<div class="line"><span class="comment">// The final function zeroes out the context automatically.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Now let&#39;s imagine we transmit the message alongside with the digest.</span></div>
<div class="line"><span class="comment">// The receiver also has the secret key and can easily verify the keyed hash.</span></div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a2f6424f124ab43b23a801f39440b9a12">ascon_hash_xof_init</a>(&amp;ctx);</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a70136fcbc6c9bcd465221acb68bcbd0c">ascon_hash_xof_update</a>(&amp;ctx, (uint8_t*) secret_key, <span class="keyword">sizeof</span>(secret_key));</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a70136fcbc6c9bcd465221acb68bcbd0c">ascon_hash_xof_update</a>(&amp;ctx, (uint8_t*) message_pt1, strlen(message_pt1));</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a70136fcbc6c9bcd465221acb68bcbd0c">ascon_hash_xof_update</a>(&amp;ctx, (uint8_t*) message_pt2, strlen(message_pt2));</div>
<div class="line"><a class="code hl_function" href="ascon_8h.html#a70136fcbc6c9bcd465221acb68bcbd0c">ascon_hash_xof_update</a>(&amp;ctx, (uint8_t*) message_pt3, strlen(message_pt3));</div>
<div class="line"><span class="comment">// A handy function computing the obtained digest and validating it</span></div>
<div class="line"><span class="comment">// against the obtained.</span></div>
<div class="line"><span class="keywordtype">bool</span> is_tag_valid = <a class="code hl_function" href="ascon_8h.html#a7bff26b9462fe7029391a5ec6650aac8">ascon_hash_xof_final_matches</a>(&amp;ctx, digest, <span class="keyword">sizeof</span>(digest));</div>
<div class="line"><span class="keywordflow">if</span> (is_tag_valid == <a class="code hl_define" href="ascon_8h.html#ae4039ea40dc117ac4189ec25a812293e">ASCON_TAG_OK</a>) {</div>
<div class="line">    puts(<span class="stringliteral">&quot;Correct decryption!&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> { <span class="comment">// ASCON_TAG_INVALID</span></div>
<div class="line">    puts(<span class="stringliteral">&quot;Something went wrong!&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="aascon_8h_html_a2f6424f124ab43b23a801f39440b9a12"><div class="ttname"><a href="ascon_8h.html#a2f6424f124ab43b23a801f39440b9a12">ascon_hash_xof_init</a></div><div class="ttdeci">ASCON_API void ascon_hash_xof_init(ascon_hash_ctx_t *ctx)</div><div class="ttdoc">Online Ascon Hash with custom digest length (eXtendable Output Function, XOF), initialisation.</div></div>
<div class="ttc" id="aascon_8h_html_a70136fcbc6c9bcd465221acb68bcbd0c"><div class="ttname"><a href="ascon_8h.html#a70136fcbc6c9bcd465221acb68bcbd0c">ascon_hash_xof_update</a></div><div class="ttdeci">ASCON_API void ascon_hash_xof_update(ascon_hash_ctx_t *ctx, const uint8_t *data, size_t data_len)</div><div class="ttdoc">Online Ascon Hash with custom digest length (eXtendable Output Function, XOF), feeding data to hash.</div></div>
<div class="ttc" id="aascon_8h_html_a7bff26b9462fe7029391a5ec6650aac8"><div class="ttname"><a href="ascon_8h.html#a7bff26b9462fe7029391a5ec6650aac8">ascon_hash_xof_final_matches</a></div><div class="ttdeci">ASCON_API bool ascon_hash_xof_final_matches(ascon_hash_ctx_t *ctx, const uint8_t *expected_digest, size_t expected_digest_len)</div><div class="ttdoc">Online Ascon Hash with custom digest length (eXtendable Output Function, XOF), finalisation and diges...</div></div>
<div class="ttc" id="aascon_8h_html_af966155aba9e0a9b14264d97ddafafdc"><div class="ttname"><a href="ascon_8h.html#af966155aba9e0a9b14264d97ddafafdc">ascon_hash_xof_final</a></div><div class="ttdeci">ASCON_API void ascon_hash_xof_final(ascon_hash_ctx_t *ctx, uint8_t *digest, size_t digest_len)</div><div class="ttdoc">Online Ascon Hash with custom digest length (eXtendable Output Function, XOF), finalisation and diges...</div></div>
<div class="ttc" id="astructascon__bufstate__t_html"><div class="ttname"><a href="structascon__bufstate__t.html">ascon_bufstate_t</a></div><div class="ttdoc">Internal cipher sponge state associated with a buffer holding for less-than-rate updates.</div><div class="ttdef"><b>Definition:</b> ascon.h:184</div></div>
</div><!-- fragment --><p >For more examples, check the test suite and how the Ascon API is used in there.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Dependencies of the library</h1>
<p >Only the C standard library, mostly C99 features:</p>
<ul>
<li><code>stdint.h</code>: <code>uint8_t</code>, <code>uint_fast8_t</code>, <code>uint64_t</code></li>
<li><code>stddef.h</code>: <code>size_t</code>, <code>NULL</code></li>
<li><code>stdbool.h</code>: <code>bool</code>, <code>true</code>, <code>false</code></li>
</ul>
<p >Optional dependency: <code>assert.h</code>, for <code>assert()</code>. Used to add runtime checks of the Ascon API input for debugging (NULL pointers and incorrect order of function calling). The CMake script uses it only if <code>assert.h</code> is found and only in the debug build type (<code>CMAKE_BUILD_TYPE=Debug</code>). If compiled without the included <code>CMakeLists.txt</code>, it's not used unless <code>ASCON_INPUT_ASSERTS</code> is defined at compile time. The assertion function <code>ASCON_ASSERT</code> can also be changed, if <code>assert()</code> is not available.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
FAQ</h1>
<ul>
<li><p class="startli"><b>Q</b>: May I use this library for-</p>
<p class="startli"><b>A</b>: YES! :D The library (and also the Ascon reference implementation) is released under the Creative Commons Zero (CC0) license which basically(*) means you can do whatever you want with it. Commercial purposes, personal projects, modifications of it, anything goes.</p>
<p class="startli">(*) for the legally-binding text check the <a class="el" href="md__l_i_c_e_n_s_e.html">license file</a>.</p>
</li>
<li><p class="startli"><b>Q</b>: Where is the documentation?</p>
<p class="startli"><b>A</b>: The <a href="inc/ascon.h">library header file <code>inc/ascon.h</code></a> is documented with Doxygen and you can find it <a href="https://thematjaz.github.io/LibAscon/">compiled here</a>.</p>
</li>
<li><p class="startli"><b>Q</b>: Why should I use Ascon-AEAD instead of, say, AES?</p>
<p class="startli"><b>A</b>: Ascon is designed to be lightweight (great for embedded systems) and natively supports authenticated encryption of data of any length, while AES must be wrapped in an AEAD mode such as AES-GCM, which is well-proven but heavier.</p>
</li>
<li><p class="startli"><b>Q</b>: Why should I use Ascon-Hash instead of, say, SHA-256?</p>
<p class="startli"><b>A</b>: Ascon is designed to be lightweight (great for embedded systems) and does not suffer from length-extension attacks as SHA-256, given its sponge construction (similarly to what SHA-3 does). Additionally Ascon offers also the XOF hashing producing digests of variable length.</p>
</li>
<li><p class="startli"><b>Q</b>: Who designed Ascon? Who wrote this library?</p>
<p class="startli"><b>A</b>: Check the <a class="el" href="md__a_u_t_h_o_r_s.html">Authors file</a> for details.</p>
</li>
<li><p class="startli"><b>Q</b>: I don't trust Ascon.</p>
<p class="startli"><b>A</b>: Good. You should not keep your guard up for everything, but Ascon has been selected as the primary choice for lightweight authenticated encryption in the final portfolio of the <a href="https://competitions.cr.yp.to/caesar-submissions.html">CAESAR competition (2014–2019)</a> and is currently competing in the <a href="https://csrc.nist.gov/projects/lightweight-cryptography">NIST Lightweight Cryptography competition (2019–)</a> . Cryptographers like it and that's a good sign, right?</p>
</li>
<li><p class="startli"><b>Q</b>: I don't trust this implementation.</p>
<p class="startli"><b>A</b>: Good, again. You can read the source code to see what it does to be sure ;) If you find any bugs or possible improvements, open a pull request or an issue. I would like to make as clear and as good as possible.</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md9"></a>
Known limitations</h1>
<ul>
<li>There is no architecture-specific optimisation, only a generic portable implementation using mostly <code>uint64_t</code> data types.</li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Compiling</h1>
<p >The project's compilation has been tested with GCC, Clang and CL (MSVC). Most compiler warnings have already been mitigated, so they hopefully don't occur on your platform.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Static source inclusion</h2>
<p >The project is relatively small, so you can simply include it into yours as a Git Subtree, Git Submodule or by simply copy-pasting the <code>inc</code> and <code>src</code> folders. Be sure to:</p>
<ul>
<li>Add <code>inc</code> and <code>src</code> to the include folders list (the internal header is in <code>src</code>).</li>
<li>Add <code>src</code> to the sources folders list.</li>
<li>Compile.</li>
</ul>
<h2><a class="anchor" id="autotoc_md12"></a>
Compiling Ascon into all possible targets with CMake</h2>
<p >A note if you are compiling on Windows from the command line:</p>
<ul>
<li>you will need <a href="https://docs.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=msvc-160#developer_command_file_locations">the environment variables</a> to use the MSVC toolchain from the command line</li>
<li>be sure to select the generator <code>NMake Makefiles</code> when configuring CMake</li>
</ul>
<p >Compile an out of source build:</p>
<div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Release  # On Windows add: -G &quot;NMake Makefiles&quot;</div>
<div class="line">cmake --build . --parallel 8</div>
</div><!-- fragment --><p >This will build all useful targets:</p>
<ul>
<li>static libraries:<ul>
<li><code>asconfull</code> with full feature set</li>
<li><code>ascon128</code> with only Ascon128</li>
<li><code>ascon128a</code> with only Ascon128a</li>
<li><code>ascon80pq</code> with only Ascon80pq</li>
<li><code>asconhash</code> with only Ascon-hash and Ascon-XOF</li>
<li><code>ascon128hash</code> with only Ascon128, Ascon-hash and Ascon-XOF</li>
<li><code>ascon128ahash</code> with only Ascon128a, Ascon-hash and Ascon-XOF</li>
<li><code>ascon80pqhash</code> with only Ascon80pq, Ascon-hash and Ascon-XOF for a smaller build result when not all features are needed</li>
</ul>
</li>
<li><code>ascon</code> a shared library (<code>.dll</code> or <code>.dylib</code> or <code>.so</code>) with full feature set (like <code>asconfull</code>, but shared)</li>
<li><code>testascon</code> a test runner executable , which test all features of the static library</li>
<li><code>testasconshared</code> a test runner executable , which test all features of the shared library</li>
</ul>
<p >Doxygen (if installed) is built separately to avoid recompiling it for any library change:</p>
<div class="fragment"><div class="line">cmake --build . --target ascon_doxygen</div>
</div><!-- fragment --><p >To compile only a single target, for example <code>ascon80pq</code>, run</p>
<div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">cmake --build . --target ascon80pq</div>
</div><!-- fragment --><p >To compile with the optimisation for size, use the <code>-DCMAKE_BUILD_TYPE=MinSizeRel</code> flag instead.</p>
<p >To run the test executables, call <code>ctest</code> in the build directory. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
